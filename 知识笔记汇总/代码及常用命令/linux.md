## 查询 linux 版本信息

```bash
cat /etc/os-release
```

#### 输出示例：

- **CentOS**:
  ```bash
  NAME="CentOS Linux"
  VERSION="8 (Core)"
  ID="centos"
  ID_LIKE="rhel fedora"
  VERSION_ID="8"
  ```

- **Ubuntu**:
  ```bash
  NAME="Ubuntu"
  VERSION="20.04.2 LTS (Focal Fossa)"
  ID="ubuntu"
  ID_LIKE="debian"
  VERSION_ID="20.04"
  ```

## fuser

`fuser` 是一个 Linux 命令，用于识别哪些进程正在访问指定的文件或文件系统。它可以帮助你找到在使用某个文件或挂载点的进程，并且能够强制终止这些进程，以便进行后续的操作，比如卸载文件系统。

### 常用功能

- **查看使用某个文件或挂载点的进程**：

  ```bash
  fuser /path/to/file_or_mountpoint
  ```

  这会返回访问该文件或挂载点的进程 ID（PID）。

- **显示详细信息**：

  如果想查看更详细的信息，可以使用 `-v` 选项：

  ```bash
  fuser -v /path/to/file_or_mountpoint
  ```

- **强制终止进程**：

  你可以使用 `-k` 选项来强制结束访问该文件或挂载点的所有进程。例如：

  ```bash
  fuser -k /path/to/mountpoint
  ```

  这会结束所有正在使用该挂载点的进程。

## ps 查看进程信息

`ps -p <PID> -o pid,uid,gid,user,cmd`

## rm -rf name/* 报错 Argument list too logng

当你尝试使用 `rm -rf name/*` 删除一个包含大量文件的目录时，可能会遇到 "Argument list too long" 的错误。这是因为 shell 对命令行参数的长度有限制。

### 解决方案

1. **使用 `find` 命令**：
   `find` 命令可以递归地查找并删除目录中的所有文件，而不受参数长度限制。

   ```bash
   find name -type f -exec rm -f {} +
   ```

- `-type f` 表示只查找文件（不包括目录）。
- `-exec rm -f {} +` 会将找到的文件传递给 `rm` 命令进行删除。

2. **使用 `xargs`**：
   `xargs` 可以将标准输入中的数据转换为命令行参数，并适用于处理大量文件。

   ```bash
   ls name | xargs rm -f
   ```

- 这里，`ls name` 列出目录中的所有文件，然后 `xargs` 将这些文件作为参数传递给 `rm -f`。

注意：如果文件名中包含空格或特殊字符，使用 `-print0` 和 `-0` 选项可以更安全地处理这些文件名：

   ```bash
   find name -type f -print0 | xargs -0 rm -f
   ```

### 组件解析

**`find name -type f -exec rm -f {} +` 命令的功能是递归查找并删除指定目录中的所有文件。以下是对这个命令的详细解释：**

1. **find**：这是一个用于查找文件和目录的命令。

2. **name**：这是你要查找的目录的名称（可以是相对路径或绝对路径）。`find` 将在这个目录及其子目录中查找。

3. **-type f**：
    - 这个选项指定只查找文件（`f` 表示文件）。
    - 这意味着该命令不会查找目录或其他类型的文件（如符号链接）。

4. **-exec**：这是 `find` 命令的一个选项，允许你对找到的每个文件执行一个命令。

5. **rm -f**：
    - `rm` 是用来删除文件的命令。
    - `-f` 选项表示“强制”删除，不会提示用户确认，也不会显示错误信息（如文件不存在）。

6. **{}**：这是一个占位符，代表 `find` 找到的每一个文件。每找到一个文件，`{}` 就会被该文件的路径替换。

7. **+**：这个符号表示 `find` 将尽可能多的文件传递给 `rm -f` 命令，而不是每找到一个文件就执行一次 `rm`。这提高了命令的效率，避免了调用 `rm` 多次，减少了系统开销。

### 总结

这个命令的作用是递归地查找 `name` 目录及其子目录中的所有文件，并强制删除它们。由于使用了 `+`，该命令能有效地处理大量文件，而不会出现参数列表过长的错误。这种方式比单独删除每个文件更高效。

## lsof

`lsof`（List Open
Files）是一个在Unix和Linux系统上使用的命令行工具，用于显示当前打开的文件和它们的相关进程信息。在Unix和Linux系统中，几乎所有内容都是文件，包括常规文件、目录、网络连接、设备等等。因此，`lsof`
的应用非常广泛。以下是`lsof`的一些主要用途和功能：

### 常见用途

1. **查看系统中的所有打开文件：**
   ```
   lsof
   ```

2. **查看某个进程打开的文件：**
   ```
   lsof -p <PID>
   ```
   例如：
   ```
   lsof -p 1234
   ```

3. **查看某个用户打开的文件：**
   ```
   lsof -u <用户名>
   ```
   例如：
   ```
   lsof -u root
   ```

4. **查看某个文件被哪个进程打开：**
   ```
   lsof <文件路径>
   ```
   例如：
   ```
   lsof /var/log/syslog
   ```

5. **查看某个端口被哪个进程占用：**
   ```
   lsof -i :<端口号>
   ```
   例如：
   ```
   lsof -i :80
   ```

6. **查看与网络相关的文件：**
   ```
   lsof -i
   ```
   这个命令会列出所有打开的网络文件（即网络连接）。

7. **查看使用某个协议的连接：**
   ```
   lsof -i <协议>
   ```
   例如：
   ```
   lsof -i TCP
   lsof -i UDP
   ```

8. **查看某个文件系统中的所有打开文件：**
   ```
   lsof +D <目录路径>
   ```
   例如：
   ```
   lsof +D /home
   ```

### 常见选项

- `-a`：将多个选项组合使用时取“与”关系。
- `-c <进程名>`：仅显示指定进程名的打开文件。
- `-d <文件描述符>`：过滤出特定文件描述符的文件。
- `-g <组ID>`：显示属于指定组ID的进程。
- `-n`：不将网络号码解析为主机名，提高运行速度。
- `-r <时间间隔>`：重复执行lsof命令，并每隔指定时间间隔刷新一次结果。

## du

要查看文件夹的容量，可以使用`du`（disk usage）命令。`du`命令会递归地计算目录及其子目录中的磁盘使用情况，并显示每个目录的磁盘使用量。以下是一些常用的`du`命令示例及其用法：

### 查看单个文件夹的容量

1. **基本用法**：
   ```bash
   du /path/to/directory
   ```
   这个命令会显示指定目录及其所有子目录的磁盘使用情况。

2. **以人类可读的格式显示（如KB, MB, GB）**：
   ```bash
   du -h /path/to/directory
   du -h --max-depth=1 /path/to/directory
   ```
    - `-h`选项使输出更易读。
    - ` --max-depth=1`：限制显示的目录层级为1，即仅显示当前目录下的文件和文件夹的容量。

3. **只显示总容量**：
   ```bash
   du -sh /path/to/directory
   ```
   `-s`选项表示汇总，只显示指定目录的总容量，而不显示子目录的详细信息。
   `-h`选项表示以人类可读的格式显示。

### 解释

- `du`：命令本身，用于显示磁盘使用情况。
- `-h`：以人类可读的格式显示（如KB, MB, GB）。
- `-s`：汇总模式，只显示指定目录的总容量。
- `/path/to/directory`：你要查看的目录的路径。